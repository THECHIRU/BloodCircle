# Deployment Guide for Render

This guide will help you deploy the Blood Donation Network application to Render.

## Prerequisites

1. A [Render account](https://render.com) (free tier available)
2. Your code pushed to a GitHub repository
3. Gmail account with App Password for email functionality
4. (Optional) Twilio account for SMS OTP

## Step-by-Step Deployment

### 1. Prepare Your Repository

Make sure all files are committed and pushed to GitHub:
```bash
git add .
git commit -m "Prepare for Render deployment"
git push origin main
```

### 2. Create a New Web Service on Render

1. Log in to [Render Dashboard](https://dashboard.render.com)
2. Click **"New +"** button and select **"Blueprint"**
3. Connect your GitHub repository
4. Render will automatically detect the `render.yaml` file

### 3. Configure Environment Variables

After the blueprint is created, go to your web service settings and add these environment variables:

#### Required Variables:
- `SECRET_KEY`: Auto-generated by Render (already set)
- `FLASK_ENV`: production (already set)
- `DATABASE_URL`: Auto-connected from PostgreSQL database (already set)

#### Email Configuration (Required for OTP):
- `MAIL_SERVER`: smtp.gmail.com
- `MAIL_PORT`: 587
- `MAIL_USE_TLS`: true
- `MAIL_USERNAME`: your-email@gmail.com
- `MAIL_PASSWORD`: your-gmail-app-password

**To get Gmail App Password:**
1. Go to Google Account Settings → Security
2. Enable 2-Factor Authentication
3. Go to App Passwords
4. Create a new app password for "Mail"
5. Copy the 16-character password

#### Optional - Twilio Configuration (for SMS OTP):
- `TWILIO_ACCOUNT_SID`: your-account-sid
- `TWILIO_AUTH_TOKEN`: your-auth-token
- `TWILIO_PHONE_NUMBER`: your-twilio-number

### 4. Deploy

1. Click **"Apply"** to create the services
2. Render will:
   - Create a PostgreSQL database
   - Create a web service
   - Install dependencies
   - Initialize the database
   - Start your application

### 5. Access Your Application

Once deployed, Render will provide you with a URL like:
```
https://blood-donation-network.onrender.com
```

### 6. Initialize Admin Account

After first deployment, you may need to create an admin account:

1. Go to the Render Dashboard
2. Open your web service
3. Click on **"Shell"** tab
4. Run:
```bash
python create_admin.py
```

Or use the quick admin script:
```bash
python quick_admin.py
```

## Important Notes

### Free Tier Limitations
- Services spin down after 15 minutes of inactivity
- First request after inactivity may take 30-60 seconds (cold start)
- 750 hours/month of runtime

### Database Backups
- Free PostgreSQL database has limited backup retention
- Consider upgrading for production use

### HTTPS
- Render provides free SSL certificates
- Your app will be accessible via HTTPS automatically

### Custom Domain (Optional)
1. Go to your web service settings
2. Click "Custom Domain"
3. Add your domain and configure DNS

## Troubleshooting

### Build Fails
- Check the build logs in Render dashboard
- Ensure all dependencies are in `requirements.txt`
- Verify `build.sh` has execute permissions

### Application Errors
- Check the logs in Render dashboard
- Verify all environment variables are set correctly
- Check database connection

### Email Not Working
- Verify Gmail App Password is correct
- Check that 2FA is enabled on Gmail
- Ensure MAIL_USERNAME and MAIL_PASSWORD are set

## Updating Your Application

1. Push changes to GitHub:
```bash
git add .
git commit -m "Update application"
git push origin main
```

2. Render will automatically detect changes and redeploy

## Monitoring

- View logs in Render Dashboard → Your Service → Logs
- Check metrics in the Metrics tab
- Set up email alerts for deployment failures

## Support

For issues:
- Check Render documentation: https://render.com/docs
- Review application logs
- Verify environment variables

## Cost Optimization

Free tier is suitable for:
- Development
- Testing
- Low-traffic applications

For production with consistent traffic, consider:
- Upgrading to paid tier ($7/month)
- Database backups and larger storage
- Better performance and no cold starts
